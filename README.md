# Hyperapp API demo (rewrite) on Inferno and Ultradom

from app generated by `create-react-app`

by Christopher J. Brody aka @brodybits (Chris Brody)

LICENSE: ISC OR MIT

## About

Simple counter app inspired by Hyperapp demo in <https://github.com/hyperapp/hyperapp#getting-started>, on Hyperapp rewrite working on both Inferno (React API) and Ultradom (at the same time)

MOTIVATION:

- <https://medium.com/hyperapp/hyperapp-for-redux-refugees-2507c9dd1ddc>
- <https://github.com/hyperapp/hyperapp/issues/641> (desire to use Ultradom as a dependency), especially rejected idea in <https://github.com/hyperapp/hyperapp/issues/641#issuecomment-376445893> (remove VDOM from Hyperapp)

See also:
- <https://github.com/brodybits/hyperapp-micro-rewrite-demo-on-react-native> (MUCH SIMPLER IMPLEMENTATION on React Native)
- <https://github.com/brodybits/hyperapp-api-demo-on-react-only>

## Build and run

First step:

    npm install

To run in browser:

    npm start

To make production build:

    npm run build

## Quick tour

Initial state and actions (inspired by Hyperapp demo app in <https://github.com/hyperapp/hyperapp#getting-started>):

```js
const initState = { count: 0 }

const actions = {
    increase: (value) => (state) => ({ count: state.count + value }),
    decrease: (value) => (state) => ({ count: state.count - value }),
}
```

JSX view function for Inferno (React API):

```jsx
const viewOnReactAPI = (state, actions) => (
    <div>
        <h1>Hyperapp API demo on Inferno (React API)</h1>
        <button onClick={() => actions.decrease(1)}>-1</button>
        <b>{state.count}</b>
        <button onClick={() => actions.increase(1)}>+1</button>
    </div>
)
```

View for Ultradom using Hyperscript (<https://github.com/hyperhype/hyperscript>, see also <https://reactjs.org/docs/react-without-jsx.html> and sample at <https://github.com/jorgebucaran/ultradom#getting-started>):

```js
const viewOnUltradom = (state, actions) =>
    h("div", {},
        h("h1", {}, "Hyperapp API demo on Ultradom"),
        h("button", { onclick: () => actions.decrease(1) }, "-1"),
        h("b", {}, state.count),
        h("button", { onclick: () => actions.increase(1) }, "+1"),
    )
```

Note that the button `onclick` property is in Camel case (`onClick`) on React API but NOT on Ultradom or Hyperapp (HTML5 button has `onclick` property NOT in Camel case).

To start render on Inferno (React API):

```js
startViewRenderReactAPI(initState, actions, viewOnReactAPI, document.getElementById('root'))
```

To start render on Ultradom:

```js
startViewRenderUltradom(initState, actions, viewOnUltradom)
```

Rendering utility function specialized for Inferno (React API):

```js
function startViewRenderReactAPI(initState, actions, view, elem) {
    const renderView = (s, a) => render(view(s, a), elem)

    startViewRender(initState, actions, view, renderView, renderView)
}
```

Rendering utility function specialized for Ultradom:

```js
function startViewRenderUltradom(initState, actions, view) {
    const myViewState = { element: null }

    const renderViewPatch = (s, a) => patch(view(s, a), myViewState.element)

    const renderFirstViewPatch = (s, a) => {
        myViewState.element = renderViewPatch(s, a)

        document.body.appendChild(myViewState.element)
    }

    startViewRender(initState, actions, view, renderFirstViewPatch, renderViewPatch)
}
```

General view render utility function:

```js
function startViewRender(initState, actions, view, renderFirstViewPatch, renderViewPatch) {
    const mystore = { state: initState }

    const a2 = {}

    const myhelper = (af) => (v) => {
        mystore.state = af(v)(mystore.state)
        renderViewPatch(mystore.state, a2)
    }

    // actions.keys().map( (k) => a2[k] = myhelper(actions[k]) )
    for (let prop in actions) a2[prop] = myhelper(actions[prop])

    renderFirstViewPatch(mystore.state, a2)
}
```

## TODO

**MAJOR IMPORTANCE:**

- [Dealing with "effects" (side effects) such as I/O & delay timers (#4)](https://github.com/brodybits/hyperapp-api-demo-on-inferno-and-ultradom/issues/4)

Other:

- [(BREAKING) View API changes from "Hyperapp 2.0", hopefully closer to standard functional component API (#5)](https://github.com/brodybits/hyperapp-api-demo-on-inferno-and-ultradom/issues/5)
- [Ultradom container element as an argument (#3)](https://github.com/brodybits/hyperapp-api-demo-on-ultradom/issues/3)
- [CC0 (public domain) API specification (#1)](https://github.com/brodybits/hyperapp-api-demo-on-inferno-and-ultradom/issues/1)
- [Publish view render function modules (#2)](https://github.com/brodybits/hyperapp-api-demo-on-inferno-and-ultradom/issues/2)
- demo on codepen
- integrate with React Native
- TodoMVC app, likely based on <https://github.com/dangvanthanh/hyperapp-todomvc>
- better styling
- try on other React alternatives such as Preact, NervJS
- try with other frameworks from <https://github.com/krausest/js-framework-benchmark>
- performance comparison with competing solutions such as using Redux
